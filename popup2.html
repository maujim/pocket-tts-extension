<!doctype html>
<html>
  <head>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        width: 340px;
        padding: 16px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 13px;
        color: #333;
        background: #fafafa;
      }

      /* Status bar */
      #out {
        padding: 10px 12px;
        background: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        font-size: 12px;
        color: #555;
        min-height: 20px;
        margin-bottom: 12px;
      }

      /* Info panels */
      .info-panel {
        padding: 10px 12px;
        border-radius: 6px;
        font-size: 12px;
        margin-bottom: 10px;
        display: none;
      }

      .info-panel.visible {
        display: block;
      }

      .info-panel.span-info {
        background: #f0f7ff;
        border: 1px solid #cce0ff;
      }

      .info-panel.audio-info {
        background: #fff8f0;
        border: 1px solid #ffe0c0;
      }

      .info-panel.estimate-info {
        background: #f0fff4;
        border: 1px solid #c0f0d0;
      }

      .info-label {
        font-weight: 600;
        color: #666;
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 0.3px;
        margin-bottom: 4px;
      }

      .info-value {
        color: #333;
        line-height: 1.4;
      }

      .info-value.preview {
        font-style: italic;
        color: #666;
        margin: 6px 0;
      }

      .info-row {
        display: flex;
        justify-content: space-between;
        margin-top: 6px;
        padding-top: 6px;
        border-top: 1px solid rgba(0,0,0,0.06);
      }

      .info-row span {
        color: #888;
        font-size: 11px;
      }

      .info-row strong {
        color: #333;
        font-weight: 600;
      }

      /* Buttons */
      .btn-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .btn-row {
        display: flex;
        gap: 8px;
      }

      button {
        flex: 1;
        padding: 10px 14px;
        font-family: inherit;
        font-size: 12px;
        font-weight: 500;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.15s ease;
      }

      button:active {
        transform: scale(0.98);
      }

      button.primary {
        background: #2563eb;
        color: white;
      }

      button.primary:hover {
        background: #1d4ed8;
      }

      button.secondary {
        background: #fff;
        color: #333;
        border: 1px solid #ddd;
      }

      button.secondary:hover {
        background: #f5f5f5;
        border-color: #ccc;
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      button.primary:disabled {
        background: #93c5fd;
      }

      button.secondary:disabled {
        background: #f5f5f5;
        color: #999;
      }

      /* Divider */
      .divider {
        height: 1px;
        background: #e5e5e5;
        margin: 12px 0;
      }

      /* Pagination */
      .pagination {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 0;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        background: #fff;
        margin-bottom: 10px;
      }

      .pagination button {
        flex: 0;
        padding: 8px 12px;
        background: transparent;
        border: none;
        color: #2563eb;
        font-weight: 500;
        border-radius: 0;
      }

      .pagination button:hover:not(:disabled) {
        background: #f0f7ff;
      }

      .pagination button:disabled {
        color: #ccc;
        background: transparent;
      }

      .pagination button:first-child {
        border-right: 1px solid #e0e0e0;
        border-radius: 6px 0 0 6px;
      }

      .pagination button:last-child {
        border-left: 1px solid #e0e0e0;
        border-radius: 0 6px 6px 0;
      }

      .pagination-info {
        font-size: 12px;
        color: #666;
        text-align: center;
        flex: 1;
      }

      .pagination-info strong {
        color: #333;
      }
    </style>
  </head>
  <body>
    <div class="btn-group">
      <button id="run" class="primary">Extract Text</button>
    </div>

    <div class="divider"></div>

    <div id="out">Ready</div>

    <div id="spanInfo" class="info-panel span-info">
      <div class="info-label">Span <span id="spanIndex">0</span></div>
      <div class="info-value preview" id="spanText"></div>
      <div class="info-row">
        <span><strong id="spanLength">0</strong> characters</span>
        <span><strong id="spanWords">0</strong> words</span>
      </div>
    </div>

    <div class="pagination" id="pagination" style="display: none;">
      <button id="prevSpan" disabled>&lt; Prev</button>
      <div class="pagination-info">
        Span <strong id="currentSpan">0</strong> of <strong id="totalSpans">0</strong>
      </div>
      <button id="nextSpan" disabled>Next &gt;</button>
    </div>

    <div class="btn-group" id="jumpGroup" style="display: none;">
      <button id="jumpToSpan" class="secondary">Jump to Span</button>
    </div>

    <div class="divider"></div>

    <div id="audioInfo" class="info-panel audio-info">
      <div class="info-label">Generated Audio</div>
      <div class="info-row" style="margin-top: 0; padding-top: 0; border: none;">
        <span>WAV size</span>
        <span><strong id="wavSize">—</strong></span>
      </div>
    </div>

    <div id="estimateInfo" class="info-panel estimate-info">
      <div class="info-label">Full Document Estimate</div>
      <div class="info-row" style="margin-top: 0; padding-top: 0; border: none;">
        <span>Ratio</span>
        <span><strong id="ratioDisplay">—</strong> bytes/char</span>
      </div>
      <div class="info-row">
        <span>Total text</span>
        <span><strong id="totalChars">—</strong> chars</span>
      </div>
      <div class="info-row">
        <span>Est. audio size</span>
        <span><strong id="estimatedSize">—</strong></span>
      </div>
    </div>

    <div class="btn-group">
      <div class="btn-row">
        <button id="copy" class="secondary" disabled>Copy Text</button>
        <button id="openTab" class="secondary" disabled>Open in Tab</button>
      </div>
      <div class="btn-row">
        <button id="playFirst" class="primary" disabled>Play First Span</button>
        <button id="playCurrent" class="primary" disabled>Play Current Span</button>
      </div>
      <div class="btn-row">
        <button id="estimate" class="secondary" disabled>Estimate Full Audio</button>
      </div>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
